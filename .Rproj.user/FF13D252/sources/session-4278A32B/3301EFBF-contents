## _________________ Infos gÃ©nÃ©rales
## Nom : gg_png.R
## Auteur : Arnaud Lheureux
## Email: arnaud.lheureux@sorbonne-universite.fr
##
## Date de crÃ©ation : 18 juin 2024
##
## Copyright (c) Arnaud Lheureux, 2024
## R version : 4.4
## _________________

## _________________ Notes
#
#' Fonction qui sauve un gpglot
#' @param GG_plot Le ggplot
#' @param filename Le nom sous lequel le sauver
#' @param width La largeur de l'image. Par dÃ©faut 30cm
#' @param height La hauteur de l'image. Par dÃ©faut 20cm
#' @param units L'unitÃ© des hauteur et largeur. Par dÃ©faut cm
#' @param res La rÃ©solution de l'image
#' @param path Le chemin de sauvegarde
#' @param verbose Ecrire les sorties images ou non
#' @return Un plot sauvegardÃ© au chemin spÃ©cifiÃ©
#' @export 
#
## ---------------------------

gg_png <- function(GG_plot, filename, width = 30, height = 20, units = "cm", res = 300, path=NULL,
                  verbose = TRUE, ...){
  
  
  if(!is.null(path)){
    if(!dir.exists(path))
      dir.create(path, recursive = T)
    
    filename <- file.path(path,filename)
  }

  
  png(filename = filename, width = width, height = height, units = units, res = res)
  invisible(print(GG_plot))
  dev.off()
  
  
  if (verbose) {
    if (is.null(path)) {
      cat(
        "\nImage sauvÃ©e dans", getwd(), ":)", "\n", "Largeur =", paste0(width, units),
        "Hauteur =", paste0(height, units), "RÃ©solution =", res, "\n"
      )
    } else {
      cat(
        "\nImage sauvÃ©e dans", path, ":)", "\n", "Largeur =", paste0(width, units),
        "Hauteur =", paste0(height, units), "RÃ©solution =", res, "\n"
      )
    }
  }

  
}
